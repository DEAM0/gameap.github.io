---
title: GameAP Daemon спецификация
layout: default
lang: ru
category: Общее
---

# Файловый сервер

Сервер обменивается с клиентом данными Binn List

## Запрос

Первый элемент в списке Binn строки должен содержать код команды (чтение директории, удаление файла и т.п.).

Например, чтение каталога:

| Тип       | Значение/Пример       |      Описание             |
|-----------|-----------------------|---------------------------|
| uint8     | 4                     | Код чтения директории     |
| string    | /home/gameap          | Каталог
| uint8     | 1                     | Режим чтения (0 - только список файлов/директорий, 1 - подробный список с информацией о размере файлов, даты модификации и пр.)

## Ответ

### Простой ответ

Простой ответ сервера содержит код (100 в случае успеха) и сообщение.

| Тип       |      Описание |
|-----------|---------------|
| uint      | Код           |
| string    | Сообщение     |

### Ответ с данными

Ответ с данными, например списоком файлов в директории.

| Тип       |      Описание |
|-----------|---------------|
| uint      | Код           |
| string    | Сообщение     |
| mixed     | Данные        |

### Коды ответов

| Код       | Описание                      |
|-----------|-------------------------------|
| 1         | Общая ошибка                  |
| 2         | Критическая ошибка            |
| 3         | Неизвестная команда           |
| 100       | Успешное выполнение команды   |

## Перемещение файлов

### Запрос

| Тип       |      Описание         | Значение/Пример |
|-----------|-----------------------|---------------
| uint8     | Код                   | 3
| uint8     | Режим (1 - скачивание с сервера, 2 - загрузка на сервер) | 1
| string    | Файл                  | /home/gameap/file.txt

### Ответ

Сервер вернёт вам простой ответ с результатами выполнения команды. 
После успешного ответа сервер будет готов для отправки/получения файла

## Листинг файлов в каталоге

Получение списка файлов в директории. 
Есть несколько режимов чтения -- простой, получение только списка файлов/директорий и подробный
с получением данных о размере файлов, даты модификации и т.д.

### Запрос

| Тип       |      Описание         | Значение/Пример |
|-----------|-----------------------|---------------
| uint8     | Код чтения каталога   | 4
| string    | Каталог               | /home/gameap
| uint8     | Режим (0 - простой, 1 - подробный)                | 1

### Ответ

Массив с данными

| Тип       |      Описание                             |
|-----------|-------------------------------------------|
| string    | Имя файла 
| uint64    | Размер файла (байт)
| uint64    | Дата модификации (timestamp)
| uint8     | Тип (1 - каталог, 2 - файл, символическая ссылка, socket, pipe)

## Создание каталога

Создать новый каталог

### Запрос

| Тип       |      Описание         | Значение/Пример |
|-----------|-----------------------|---------------
| uint8     | Код чтения каталога   | 5
| string    | Каталог               | /home/gameap/new_dir

### Ответ

Сервер вернёт вам простой ответ с результатами выполнения команды.

## Перемещение/копирование

Перемещение или копирование каталога/директории

### Запрос

| Тип       |      Описание         | Значение/Пример |
|-----------|-----------------------|---------------
| uint8     | Код                   | 6
| string     | Текущий путь         | /home/gameap/old_file.txt
| string    | Новый путь            | /home/gameap/new_file.txt
| boolean    | Копирование (true/false). <br><br> Если false, то файл будет перемещён. Если true, то файл будет скопирован.          | true

### Ответ

Сервер вернёт простой ответ с результатами выполнения команды.

## Удаление

Удаление файла/директории

### Запрос

| Тип       |      Описание            | Значение/Пример |
|-----------|--------------------------|---------------
| uint8     | Код                      | 7
| string    | Путь к файлу, каталогу   | /home/gameap/delete_file.txt
| bool      | Рекурсивное удаление каталога     | false

### Ответ

Сервер вернёт простой ответ с результатами выполнения команды.

## Подробная информация о файле

Получение развёрнутой информации об одном файле (даты создания, даты модификации, даты последнего доступа, mime и прочего).

### Запрос

| Тип       |      Описание            | Значение/Пример |
|-----------|--------------------------|---------------
| uint8     | Код                      | 8
| string    | Путь к файлу, каталогу   | /home/gameap/file.txt

### Ответ

Ответ с данными

| Тип       |      Описание                             |
|-----------|-------------------------------------------|
| string    | Имя файла 
| uint64    | Размер файла (байт)
| uint8     | Тип <br><br> 1 - каталог;<br> 2 - файл;<br> 3 - character device;<br>4 - block device;<br>5 - named pipe;<br>6 - символическая ссылка;<br>7 - сокет;<br> 0 - неизвестно
| uint64    | Дата модификации (timestamp)
| uint64    | Дата доступа (timestamp)
| uint64    | Дата создания (timestamp)
| string    | Mime

